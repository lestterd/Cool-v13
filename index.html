<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ğŸ° Lottery 1-100</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body{
    background:black;
    color:gold;
    text-align:center;
    font-family:Arial;
}

.grid{
    display:grid;
    grid-template-columns: repeat(10, 1fr);
    gap:5px;
    margin:20px;
}

.numero{
    padding:10px;
    background:#222;
    border:1px solid gold;
    cursor:pointer;
}

.numero.vendido{
    background:red;
    cursor:not-allowed;
}

button{
    padding:10px 20px;
    margin-top:10px;
    background:gold;
    border:none;
    cursor:pointer;
}

#winner{
    margin-top:20px;
    font-size:20px;
}
</style>
</head>

<body>

<h1>ğŸ° LOTTERY 1-100 ğŸ°</h1>
<h3>Precio por nÃºmero: $0.99</h3>

<input type="text" id="telegramId" placeholder="Tu ID de Telegram"><br>

<div class="grid" id="numeros"></div>

<button onclick="elegirGanador()">ğŸ¯ Elegir Ganador</button>

<div id="winner"></div>

<script>

let vendidos = {};
let animando = false;
let ganadorFinal = null;

const grid = document.getElementById("numeros");

let user = Telegram.WebApp.initDataUnsafe.user;
let telegramId = user ? user.id : "Desconocido";

for(let i=1;i<=100;i++){
    let div = document.createElement("div");
    div.innerText = i;
    div.classList.add("numero");

    div.onclick = function(){

        if(animando) return;

        if(vendidos[i]){
            alert("NÃºmero ya vendido");
            return;
        }

        vendidos[i] = telegramId;
        div.classList.add("vendido");
    }

    grid.appendChild(div);
}

function elegirGanador(){

    if(animando) return;

    let claves = Object.keys(vendidos);

    if(claves.length == 0){
        alert("No hay nÃºmeros vendidos");
        return;
    }

    animando = true;

    let contador = 0;

    let intervalo = setInterval(function(){

        let randomVisual = Math.floor(Math.random()*100)+1;
        document.getElementById("winner").innerHTML =
        "ğŸ² Sorteando: " + randomVisual;

        contador++;

        if(contador >= 100){ // 100 cambios â‰ˆ 10 segundos
            clearInterval(intervalo);

            let random = claves[Math.floor(Math.random()*claves.length)];
            ganadorFinal = random;

            document.getElementById("winner").innerHTML =
            "ğŸ† NÃºmero ganador: " + random;

            animando = false;
        }

    },100);
}

</script>
